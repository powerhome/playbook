dependencies:
  override: []

deploy:
  max_commits: # Automatically deploy all commits, no matter how many.
  override:
    - ./bin/deployer bash -lc "cluster=app-prod-hq environment=${ENVIRONMENT} tag=${REVISION} deploy_url=${DEPLOY_URL} bin/deploy"

links:
  logs: "https://logging.prod.hq.powerapp.cloud/app/kibana#/discover?_g=(refreshInterval:(pause:!f,value:5000),time:(from:now-15m,mode:quick,to:now))&_a=(columns:!(log),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:ae758a80-1475-11eb-a138-277caf074f3e,key:kubernetes.namespace_name,negate:!f,params:(query:playbook-production,type:phrase),type:phrase,value:playbook-production),query:(match:(kubernetes.namespace_name:(query:playbook-production,type:phrase))))),index:ae758a80-1475-11eb-a138-277caf074f3e,interval:auto,query:(language:lucene,query:''),sort:!('@timestamp',desc))"
  metrics: "https://metrics.prod.hq.powerapp.cloud/d/hYTBQhQiz/pod-resource-usage?orgId=1&refresh=10s&var-datasource=prometheus-app-prod-hq&var-namespace=playbook-production&var-filter=.%2B&var-pod=All"

ci:
  require:
    - powerhome/image
    - continuous-integration/jenkins/branch
    - powerhome/deploy/staging

review:
  checklist: []

status:
  context: powerhome/deploy/production
