{"version":3,"file":"IsoFS.js","sourceRoot":"","sources":["../../../src/backend/IsoFS.ts"],"names":[],"mappings":"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","sourcesContent":["import {ApiError, ErrorCode} from '../core/api_error';\nimport {default as Stats, FileType} from '../core/node_fs_stats';\nimport {SynchronousFileSystem, FileSystem, BFSCallback, FileSystemOptions} from '../core/file_system';\nimport {File} from '../core/file';\nimport {FileFlag, ActionType} from '../core/file_flag';\nimport {NoSyncFile} from '../generic/preload_file';\nimport {copyingSlice, bufferValidator} from '../core/util';\nimport * as path from 'path';\n\n/**\n * @hidden\n */\nconst rockRidgeIdentifier = \"IEEE_P1282\";\n/**\n * @hidden\n */\nconst enum VolumeDescriptorTypeCode {\n  BootRecord = 0,\n  PrimaryVolumeDescriptor = 1,\n  SupplementaryVolumeDescriptor = 2,\n  VolumePartitionDescriptor = 3,\n  VolumeDescriptorSetTerminator = 255\n}\n\n/**\n * @hidden\n */\ntype TGetString = (d: Buffer, i: number, len: number) => string;\n\n/**\n * @hidden\n */\nfunction getASCIIString(data: Buffer, startIndex: number, length: number) {\n  return data.toString('ascii', startIndex, startIndex + length).trim();\n}\n\n/**\n * @hidden\n */\nfunction getJolietString(data: Buffer, startIndex: number, length: number): string {\n  if (length === 1) {\n    // Special: Root, parent, current directory are still a single byte.\n    return String.fromCharCode(data[startIndex]);\n  }\n  // UTF16-BE, which isn't natively supported by NodeJS Buffers.\n  // Length should be even, but pessimistically floor just in case.\n  const pairs = Math.floor(length / 2);\n  const chars = new Array(pairs);\n  for (let i = 0; i < pairs; i++) {\n    const pos = startIndex + (i << 1);\n    chars[i] = String.fromCharCode(data[pos + 1] | (data[pos] << 8));\n  }\n  return chars.join('');\n}\n\n/**\n * @hidden\n */\nfunction getDate(data: Buffer, startIndex: number): Date {\n  const year = parseInt(getASCIIString(data, startIndex, 4), 10);\n  const mon = parseInt(getASCIIString(data, startIndex + 4, 2), 10);\n  const day = parseInt(getASCIIString(data, startIndex + 6, 2), 10);\n  const hour = parseInt(getASCIIString(data, startIndex + 8, 2), 10);\n  const min = parseInt(getASCIIString(data, startIndex + 10, 2), 10);\n  const sec = parseInt(getASCIIString(data, startIndex + 12, 2), 10);\n  const hundrethsSec = parseInt(getASCIIString(data, startIndex + 14, 2), 10);\n  // Last is a time-zone offset, but JavaScript dates don't support time zones well.\n  return new Date(year, mon, day, hour, min, sec, hundrethsSec * 100);\n}\n\n/**\n * @hidden\n */\nfunction getShortFormDate(data: Buffer, startIndex: number): Date {\n  const yearsSince1900 = data[startIndex];\n  const month = data[startIndex + 1];\n  const day = data[startIndex + 2];\n  const hour = data[startIndex + 3];\n  const minute = data[startIndex + 4];\n  const second = data[startIndex + 5];\n  // JavaScript's Date support isn't so great; ignore timezone.\n  // const offsetFromGMT = this._data[24];\n  return new Date(yearsSince1900, month - 1, day, hour, minute, second);\n}\n\n/**\n * @hidden\n */\nfunction constructSystemUseEntry(bigData: Buffer, i: number): SystemUseEntry {\n  const data = bigData.slice(i);\n  const sue = new SystemUseEntry(data);\n  switch (sue.signatureWord()) {\n    case SystemUseEntrySignatures.CE:\n      return new CEEntry(data);\n    case SystemUseEntrySignatures.PD:\n      return new  PDEntry(data);\n    case SystemUseEntrySignatures.SP:\n      return new SPEntry(data);\n    case SystemUseEntrySignatures.ST:\n      return new STEntry(data);\n    case SystemUseEntrySignatures.ER:\n      return new EREntry(data);\n    case SystemUseEntrySignatures.ES:\n      return new ESEntry(data);\n    case SystemUseEntrySignatures.PX:\n      return new PXEntry(data);\n    case SystemUseEntrySignatures.PN:\n      return new PNEntry(data);\n    case SystemUseEntrySignatures.SL:\n      return new SLEntry(data);\n    case SystemUseEntrySignatures.NM:\n      return new NMEntry(data);\n    case SystemUseEntrySignatures.CL:\n      return new CLEntry(data);\n    case SystemUseEntrySignatures.PL:\n      return new PLEntry(data);\n    case SystemUseEntrySignatures.RE:\n      return new REEntry(data);\n    case SystemUseEntrySignatures.TF:\n      return new TFEntry(data);\n    case SystemUseEntrySignatures.SF:\n      return new SFEntry(data);\n    case SystemUseEntrySignatures.RR:\n      return new RREntry(data);\n    default:\n      return sue;\n  }\n}\n\n/**\n * @hidden\n */\nfunction constructSystemUseEntries(data: Buffer, i: number, len: number, isoData: Buffer): SystemUseEntry[] {\n  // If the remaining allocated space following the last recorded System Use Entry in a System\n  // Use field or Continuation Area is less than four bytes long, it cannot contain a System\n  // Use Entry and shall be ignored\n  len = len - 4;\n  let entries = new Array<SystemUseEntry>();\n  while (i < len) {\n    const entry = constructSystemUseEntry(data, i);\n    const length = entry.length();\n    if (length === 0) {\n      // Invalid SU section; prevent infinite loop.\n      return entries;\n    }\n    i += length;\n    if (entry instanceof STEntry) {\n      // ST indicates the end of entries.\n      break;\n    }\n    if (entry instanceof CEEntry) {\n      entries = entries.concat(entry.getEntries(isoData));\n    } else {\n      entries.push(entry);\n    }\n  }\n  return entries;\n}\n\n/**\n * @hidden\n */\nclass VolumeDescriptor {\n  protected _data: Buffer;\n  constructor(data: Buffer) {\n    this._data = data;\n  }\n  public type(): VolumeDescriptorTypeCode {\n    return this._data[0];\n  }\n  public standardIdentifier(): string {\n    return getASCIIString(this._data, 1, 5);\n  }\n  public version(): number {\n    return this._data[6];\n  }\n  public data(): Buffer {\n    return this._data.slice(7, 2048);\n  }\n}\n\n/**\n * @hidden\n */\nabstract class PrimaryOrSupplementaryVolumeDescriptor extends VolumeDescriptor {\n  private _root: DirectoryRecord | null = null;\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public systemIdentifier(): string {\n    return this._getString32(8);\n  }\n  public volumeIdentifier(): string {\n    return this._getString32(40);\n  }\n  public volumeSpaceSize(): number {\n    return this._data.readUInt32LE(80);\n  }\n  public volumeSetSize(): number {\n    return this._data.readUInt16LE(120);\n  }\n  public volumeSequenceNumber(): number {\n    return this._data.readUInt16LE(124);\n  }\n  public logicalBlockSize(): number {\n    return this._data.readUInt16LE(128);\n  }\n  public pathTableSize(): number {\n    return this._data.readUInt32LE(132);\n  }\n  public locationOfTypeLPathTable(): number {\n    return this._data.readUInt32LE(140);\n  }\n  public locationOfOptionalTypeLPathTable(): number {\n    return this._data.readUInt32LE(144);\n  }\n  public locationOfTypeMPathTable(): number {\n    return this._data.readUInt32BE(148);\n  }\n  public locationOfOptionalTypeMPathTable(): number {\n    return this._data.readUInt32BE(152);\n  }\n  public rootDirectoryEntry(isoData: Buffer): DirectoryRecord {\n    if (this._root === null) {\n      this._root = this._constructRootDirectoryRecord(this._data.slice(156));\n      this._root.rootCheckForRockRidge(isoData);\n    }\n    return this._root;\n  }\n  public volumeSetIdentifier(): string {\n    return this._getString(190, 128);\n  }\n  public publisherIdentifier(): string {\n    return this._getString(318, 128);\n  }\n  public dataPreparerIdentifier(): string {\n    return this._getString(446, 128);\n  }\n  public applicationIdentifier(): string {\n    return this._getString(574, 128);\n  }\n  public copyrightFileIdentifier(): string {\n    return this._getString(702, 38);\n  }\n  public abstractFileIdentifier(): string {\n    return this._getString(740, 36);\n  }\n  public bibliographicFileIdentifier(): string {\n    return this._getString(776, 37);\n  }\n  public volumeCreationDate(): Date {\n    return getDate(this._data, 813);\n  }\n  public volumeModificationDate(): Date {\n    return getDate(this._data, 830);\n  }\n  public volumeExpirationDate(): Date {\n    return getDate(this._data, 847);\n  }\n  public volumeEffectiveDate(): Date {\n    return getDate(this._data, 864);\n  }\n  public fileStructureVersion(): number {\n    return this._data[881];\n  }\n  public applicationUsed(): Buffer {\n    return this._data.slice(883, 883 + 512);\n  }\n  public reserved(): Buffer {\n    return this._data.slice(1395, 1395 + 653);\n  }\n  public abstract name(): string;\n  protected abstract _constructRootDirectoryRecord(data: Buffer): DirectoryRecord;\n  protected abstract _getString(idx: number, len: number): string;\n  protected _getString32(idx: number): string {\n    return this._getString(idx, 32);\n  }\n}\n\n/**\n * @hidden\n */\nclass PrimaryVolumeDescriptor extends PrimaryOrSupplementaryVolumeDescriptor {\n  constructor(data: Buffer) {\n    super(data);\n    if (this.type() !== VolumeDescriptorTypeCode.PrimaryVolumeDescriptor) {\n      throw new ApiError(ErrorCode.EIO, `Invalid primary volume descriptor.`);\n    }\n  }\n  public name() {\n    return \"ISO9660\";\n  }\n  protected _constructRootDirectoryRecord(data: Buffer): DirectoryRecord {\n    return new ISODirectoryRecord(data, -1);\n  }\n  protected _getString(idx: number, len: number): string {\n    return this._getString(idx, len);\n  }\n}\n\n/**\n * @hidden\n */\nclass SupplementaryVolumeDescriptor extends PrimaryOrSupplementaryVolumeDescriptor {\n  constructor(data: Buffer) {\n    super(data);\n    if (this.type() !== VolumeDescriptorTypeCode.SupplementaryVolumeDescriptor) {\n      throw new ApiError(ErrorCode.EIO, `Invalid supplementary volume descriptor.`);\n    }\n    const escapeSequence = this.escapeSequence();\n    const third = escapeSequence[2];\n    // Third character identifies what 'level' of the UCS specification to follow.\n    // We ignore it.\n    if (escapeSequence[0] !== 0x25 || escapeSequence[1] !== 0x2F ||\n       (third !== 0x40 && third !== 0x43 && third !== 0x45)) {\n      throw new ApiError(ErrorCode.EIO, `Unrecognized escape sequence for SupplementaryVolumeDescriptor: ${escapeSequence.toString()}`);\n    }\n  }\n  public name() {\n    return \"Joliet\";\n  }\n  public escapeSequence(): Buffer {\n    return this._data.slice(88, 120);\n  }\n  protected _constructRootDirectoryRecord(data: Buffer): DirectoryRecord {\n    return new JolietDirectoryRecord(data, -1);\n  }\n  protected _getString(idx: number, len: number): string {\n    return getJolietString(this._data, idx, len);\n  }\n}\n\n/**\n * @hidden\n */\nconst enum FileFlags {\n  Hidden = 1,\n  Directory = 1 << 1,\n  AssociatedFile = 1 << 2,\n  EARContainsInfo = 1 << 3,\n  EARContainsPerms = 1 << 4,\n  FinalDirectoryRecordForFile = 1 << 5\n}\n\n/**\n * @hidden\n */\nabstract class DirectoryRecord {\n  protected _data: Buffer;\n  // Offset at which system use entries begin. Set to -1 if not enabled.\n  protected _rockRidgeOffset: number;\n  protected _suEntries: SystemUseEntry[] | null = null;\n  private _fileOrDir: Buffer | Directory<DirectoryRecord> | null = null;\n  constructor(data: Buffer, rockRidgeOffset: number) {\n    this._data = data;\n    this._rockRidgeOffset = rockRidgeOffset;\n  }\n  public hasRockRidge(): boolean {\n    return this._rockRidgeOffset > -1;\n  }\n  public getRockRidgeOffset(): number {\n    return this._rockRidgeOffset;\n  }\n  /**\n   * !!ONLY VALID ON ROOT NODE!!\n   * Checks if Rock Ridge is enabled, and sets the offset.\n   */\n  public rootCheckForRockRidge(isoData: Buffer): void {\n    const dir = this.getDirectory(isoData);\n    this._rockRidgeOffset = dir.getDotEntry(isoData)._getRockRidgeOffset(isoData);\n    if (this._rockRidgeOffset > -1) {\n      // Wipe out directory. Start over with RR knowledge.\n      this._fileOrDir = null;\n    }\n  }\n  public length(): number {\n    return this._data[0];\n  }\n  public extendedAttributeRecordLength(): number {\n    return this._data[1];\n  }\n  public lba(): number {\n    return this._data.readUInt32LE(2) * 2048;\n  }\n  public dataLength(): number {\n    return this._data.readUInt32LE(10);\n  }\n  public recordingDate(): Date {\n    return getShortFormDate(this._data, 18);\n  }\n  public fileFlags(): number {\n    return this._data[25];\n  }\n  public fileUnitSize(): number {\n    return this._data[26];\n  }\n  public interleaveGapSize(): number {\n    return this._data[27];\n  }\n  public volumeSequenceNumber(): number {\n    return this._data.readUInt16LE(28);\n  }\n  public identifier(): string {\n    return this._getString(33, this._data[32]);\n  }\n  public fileName(isoData: Buffer): string {\n    if (this.hasRockRidge()) {\n      const fn = this._rockRidgeFilename(isoData);\n      if (fn !== null) {\n        return fn;\n      }\n    }\n    const ident = this.identifier();\n    if (this.isDirectory(isoData)) {\n      return ident;\n    }\n    // Files:\n    // - MUST have 0x2E (.) separating the name from the extension\n    // - MUST have 0x3B (;) separating the file name and extension from the version\n    // Gets expanded to two-byte char in Unicode directory records.\n    const versionSeparator = ident.indexOf(';');\n    if (versionSeparator === -1) {\n      // Some Joliet filenames lack the version separator, despite the standard\n      // specifying that it should be there.\n      return ident;\n    } else if (ident[versionSeparator - 1] === '.') {\n      // Empty extension. Do not include '.' in the filename.\n      return ident.slice(0, versionSeparator - 1);\n    } else {\n      // Include up to version separator.\n      return ident.slice(0, versionSeparator);\n    }\n  }\n  public isDirectory(isoData: Buffer): boolean {\n    let rv = Boolean(this.fileFlags() && FileFlags.Directory);\n    // If it lacks the Directory flag, it may still be a directory if we've exceeded the directory\n    // depth limit. Rock Ridge marks these as files and adds a special attribute.\n    if (!rv && this.hasRockRidge()) {\n      rv = this.getSUEntries(isoData).filter((e) => e instanceof CLEntry).length > 0;\n    }\n    return rv;\n  }\n  public isSymlink(isoData: Buffer): boolean {\n    return this.hasRockRidge() && this.getSUEntries(isoData).filter((e) => e instanceof SLEntry).length > 0;\n  }\n  public getSymlinkPath(isoData: Buffer): string {\n    let p = \"\";\n    const entries = this.getSUEntries(isoData);\n    const getStr = this._getGetString();\n    for (const entry of entries) {\n      if (entry instanceof SLEntry) {\n        const components = entry.componentRecords();\n        for (const component of components) {\n          const flags = component.flags();\n          if (flags & SLComponentFlags.CURRENT) {\n            p += \"./\";\n          } else if (flags & SLComponentFlags.PARENT) {\n            p += \"../\";\n          } else if (flags & SLComponentFlags.ROOT) {\n            p += \"/\";\n          } else {\n            p += component.content(getStr);\n            if (!(flags & SLComponentFlags.CONTINUE)) {\n              p += '/';\n            }\n          }\n        }\n        if (!entry.continueFlag()) {\n          // We are done with this link.\n          break;\n        }\n      }\n    }\n    if (p.length > 1 && p[p.length - 1] === '/') {\n      // Trim trailing '/'.\n      return p.slice(0, p.length - 1);\n    } else {\n      return p;\n    }\n  }\n  public getFile(isoData: Buffer): Buffer {\n    if (this.isDirectory(isoData)) {\n      throw new Error(`Tried to get a File from a directory.`);\n    }\n    if (this._fileOrDir === null) {\n      this._fileOrDir = isoData.slice(this.lba(), this.lba() + this.dataLength());\n    }\n    return <Buffer> this._fileOrDir;\n  }\n  public getDirectory(isoData: Buffer): Directory<DirectoryRecord> {\n    if (!this.isDirectory(isoData)) {\n      throw new Error(`Tried to get a Directory from a file.`);\n    }\n    if (this._fileOrDir === null) {\n      this._fileOrDir = this._constructDirectory(isoData);\n    }\n    return <Directory<this>> this._fileOrDir;\n  }\n  public getSUEntries(isoData: Buffer): SystemUseEntry[] {\n    if (!this._suEntries) {\n      this._constructSUEntries(isoData);\n    }\n    return this._suEntries!;\n  }\n  protected abstract _getString(i: number, len: number): string;\n  protected abstract _getGetString(): TGetString;\n  protected abstract _constructDirectory(isoData: Buffer): Directory<DirectoryRecord>;\n  protected _rockRidgeFilename(isoData: Buffer): string | null {\n    const nmEntries = <NMEntry[]> this.getSUEntries(isoData).filter((e) => e instanceof NMEntry);\n    if (nmEntries.length === 0 || nmEntries[0].flags() & (NMFlags.CURRENT | NMFlags.PARENT)) {\n      return null;\n    }\n    let str = '';\n    const getString = this._getGetString();\n    for (const e of nmEntries) {\n      str += e.name(getString);\n      if (!(e.flags() & NMFlags.CONTINUE)) {\n        break;\n      }\n    }\n    return str;\n  }\n  private _constructSUEntries(isoData: Buffer): void {\n    let i = 33 + this._data[32];\n    if (i % 2 === 1) {\n      // Skip padding field.\n      i++;\n    }\n    i += this._rockRidgeOffset;\n    this._suEntries = constructSystemUseEntries(this._data, i, this.length(), isoData);\n  }\n  /**\n   * !!ONLY VALID ON FIRST ENTRY OF ROOT DIRECTORY!!\n   * Returns -1 if rock ridge is not enabled. Otherwise, returns the offset\n   * at which system use fields begin.\n   */\n  private _getRockRidgeOffset(isoData: Buffer): number {\n    // In the worst case, we get some garbage SU entries.\n    // Fudge offset to 0 before proceeding.\n    this._rockRidgeOffset = 0;\n    const suEntries = this.getSUEntries(isoData);\n    if (suEntries.length > 0) {\n      const spEntry = suEntries[0];\n      if (spEntry instanceof SPEntry && spEntry.checkBytesPass()) {\n        // SUSP is in use.\n        for (let i = 1; i < suEntries.length; i++) {\n          const entry = suEntries[i];\n          if (entry instanceof RREntry || (entry instanceof EREntry && entry.extensionIdentifier() === rockRidgeIdentifier)) {\n            // Rock Ridge is in use!\n            return spEntry.bytesSkipped();\n          }\n        }\n      }\n    }\n    // Failed.\n    this._rockRidgeOffset = -1;\n    return -1;\n  }\n}\n\n/**\n * @hidden\n */\nclass ISODirectoryRecord extends DirectoryRecord {\n  constructor(data: Buffer, rockRidgeOffset: number) {\n    super(data, rockRidgeOffset);\n  }\n  protected _getString(i: number, len: number): string {\n    return getASCIIString(this._data, i, len);\n  }\n  protected _constructDirectory(isoData: Buffer): Directory<DirectoryRecord> {\n    return new ISODirectory(this, isoData);\n  }\n  protected _getGetString(): TGetString {\n    return getASCIIString;\n  }\n}\n\n/**\n * @hidden\n */\nclass JolietDirectoryRecord extends DirectoryRecord {\n  constructor(data: Buffer, rockRidgeOffset: number) {\n    super(data, rockRidgeOffset);\n  }\n  protected _getString(i: number, len: number): string {\n    return getJolietString(this._data, i, len);\n  }\n  protected _constructDirectory(isoData: Buffer): Directory<DirectoryRecord> {\n    return new JolietDirectory(this, isoData);\n  }\n  protected _getGetString(): TGetString {\n    return getJolietString;\n  }\n}\n\n/**\n * @hidden\n */\nconst enum SystemUseEntrySignatures {\n  CE = 0x4345,\n  PD = 0x5044,\n  SP = 0x5350,\n  ST = 0x5354,\n  ER = 0x4552,\n  ES = 0x4553,\n  PX = 0x5058,\n  PN = 0x504E,\n  SL = 0x534C,\n  NM = 0x4E4D,\n  CL = 0x434C,\n  PL = 0x504C,\n  RE = 0x5245,\n  TF = 0x5446,\n  SF = 0x5346,\n  RR = 0x5252\n}\n\n/**\n * @hidden\n */\nclass SystemUseEntry {\n  protected _data: Buffer;\n  constructor(data: Buffer) {\n    this._data = data;\n  }\n  public signatureWord(): SystemUseEntrySignatures {\n    return this._data.readUInt16BE(0);\n  }\n  public signatureWordString(): string {\n    return getASCIIString(this._data, 0, 2);\n  }\n  public length(): number {\n    return this._data[2];\n  }\n  public suVersion(): number {\n    return this._data[3];\n  }\n}\n\n/**\n * Continuation entry.\n * @hidden\n */\nclass CEEntry extends SystemUseEntry {\n  private _entries: SystemUseEntry[] | null = null;\n  constructor(data: Buffer) {\n    super(data);\n  }\n  /**\n   * Logical block address of the continuation area.\n   */\n  public continuationLba(): number {\n    return this._data.readUInt32LE(4);\n  }\n  /**\n   * Offset into the logical block.\n   */\n  public continuationLbaOffset(): number {\n    return this._data.readUInt32LE(12);\n  }\n  /**\n   * Length of the continuation area.\n   */\n  public continuationLength(): number {\n    return this._data.readUInt32LE(20);\n  }\n  public getEntries(isoData: Buffer): SystemUseEntry[] {\n    if (!this._entries) {\n      const start = this.continuationLba() * 2048 + this.continuationLbaOffset();\n      this._entries = constructSystemUseEntries(isoData, start, this.continuationLength(), isoData);\n    }\n    return this._entries;\n  }\n}\n\n/**\n * Padding entry.\n * @hidden\n */\nclass PDEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n}\n\n/**\n * Identifies that SUSP is in-use.\n * @hidden\n */\nclass SPEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public checkBytesPass(): boolean {\n    return this._data[4] === 0xBE && this._data[5] === 0xEF;\n  }\n  public bytesSkipped(): number {\n    return this._data[6];\n  }\n}\n\n/**\n * Identifies the end of the SUSP entries.\n * @hidden\n */\nclass STEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n}\n\n/**\n * Specifies system-specific extensions to SUSP.\n * @hidden\n */\nclass EREntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public identifierLength(): number {\n    return this._data[4];\n  }\n  public descriptorLength(): number {\n    return this._data[5];\n  }\n  public sourceLength(): number {\n    return this._data[6];\n  }\n  public extensionVersion(): number {\n    return this._data[7];\n  }\n  public extensionIdentifier(): string {\n    return getASCIIString(this._data, 8, this.identifierLength());\n  }\n  public extensionDescriptor(): string {\n    return getASCIIString(this._data, 8 + this.identifierLength(), this.descriptorLength());\n  }\n  public extensionSource(): string {\n    return getASCIIString(this._data, 8 + this.identifierLength() + this.descriptorLength(), this.sourceLength());\n  }\n}\n\n/**\n * @hidden\n */\nclass ESEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public extensionSequence(): number {\n    return this._data[4];\n  }\n}\n\n/**\n * RockRidge: Marks that RockRidge is in use [deprecated]\n * @hidden\n */\nclass RREntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n}\n\n/**\n * RockRidge: Records POSIX file attributes.\n * @hidden\n */\nclass PXEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public mode(): number {\n    return this._data.readUInt32LE(4);\n  }\n  public fileLinks(): number {\n    return this._data.readUInt32LE(12);\n  }\n  public uid(): number {\n    return this._data.readUInt32LE(20);\n  }\n  public gid(): number {\n    return this._data.readUInt32LE(28);\n  }\n  public inode(): number {\n    return this._data.readUInt32LE(36);\n  }\n}\n\n/**\n * RockRidge: Records POSIX device number.\n * @hidden\n */\nclass PNEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public devTHigh(): number {\n    return this._data.readUInt32LE(4);\n  }\n  public devTLow(): number {\n    return this._data.readUInt32LE(12);\n  }\n}\n\n/**\n * RockRidge: Records symbolic link\n * @hidden\n */\nclass SLEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public flags(): number {\n    return this._data[4];\n  }\n  public continueFlag(): number {\n    return this.flags() & 0x1;\n  }\n  public componentRecords(): SLComponentRecord[] {\n    const records = new Array<SLComponentRecord>();\n    let i = 5;\n    while (i < this.length()) {\n      const record = new SLComponentRecord(this._data.slice(i));\n      records.push(record);\n      i += record.length();\n    }\n    return records;\n  }\n}\n\n/**\n * @hidden\n */\nconst enum SLComponentFlags {\n  CONTINUE = 1,\n  CURRENT = 1 << 1,\n  PARENT = 1 << 2,\n  ROOT = 1 << 3\n}\n\n/**\n * @hidden\n */\nclass SLComponentRecord {\n  private _data: Buffer;\n  constructor(data: Buffer) {\n    this._data = data;\n  }\n  public flags(): SLComponentFlags {\n    return this._data[0];\n  }\n  public length(): number {\n    return 2 + this.componentLength();\n  }\n  public componentLength(): number {\n    return this._data[1];\n  }\n  public content(getString: TGetString): string {\n    return getString(this._data, 2, this.componentLength());\n  }\n}\n\n/**\n * @hidden\n */\nconst enum NMFlags {\n  CONTINUE = 1,\n  CURRENT = 1 << 1,\n  PARENT = 1 << 2\n}\n\n/**\n * RockRidge: Records alternate file name\n * @hidden\n */\nclass NMEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public flags(): NMFlags {\n    return this._data[4];\n  }\n  public name(getString: TGetString): string {\n    return getString(this._data, 5, this.length() - 5);\n  }\n}\n\n/**\n * RockRidge: Records child link\n * @hidden\n */\nclass CLEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public childDirectoryLba(): number {\n    return this._data.readUInt32LE(4);\n  }\n}\n\n/**\n * RockRidge: Records parent link.\n * @hidden\n */\nclass PLEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public parentDirectoryLba(): number {\n    return this._data.readUInt32LE(4);\n  }\n}\n\n/**\n * RockRidge: Records relocated directory.\n * @hidden\n */\nclass REEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n}\n\n/**\n * @hidden\n */\nconst enum TFFlags {\n  CREATION = 1,\n  MODIFY = 1 << 1,\n  ACCESS = 1 << 2,\n  ATTRIBUTES = 1 << 3,\n  BACKUP = 1 << 4,\n  EXPIRATION = 1 << 5,\n  EFFECTIVE = 1 << 6,\n  LONG_FORM = 1 << 7\n}\n\n/**\n * RockRidge: Records file timestamps\n * @hidden\n */\nclass TFEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public flags(): number {\n    return this._data[4];\n  }\n  public creation(): Date | null {\n    if (this.flags() & TFFlags.CREATION) {\n      if (this._longFormDates()) {\n        return getDate(this._data, 5);\n      } else {\n        return getShortFormDate(this._data, 5);\n      }\n    } else {\n      return null;\n    }\n  }\n  public modify(): Date | null {\n    if (this.flags() & TFFlags.MODIFY) {\n      const previousDates = (this.flags() & TFFlags.CREATION) ? 1 : 0;\n      if (this._longFormDates()) {\n        return getDate(this._data, 5 + (previousDates * 17));\n      } else {\n        return getShortFormDate(this._data, 5 + (previousDates * 7));\n      }\n    } else {\n      return null;\n    }\n  }\n  public access(): Date | null {\n    if (this.flags() & TFFlags.ACCESS) {\n      let previousDates = (this.flags() & TFFlags.CREATION) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.MODIFY) ? 1 : 0;\n      if (this._longFormDates()) {\n        return getDate(this._data, 5 + (previousDates * 17));\n      } else {\n        return getShortFormDate(this._data, 5 + (previousDates * 7));\n      }\n    } else {\n      return null;\n    }\n  }\n  public backup(): Date | null {\n    if (this.flags() & TFFlags.BACKUP) {\n      let previousDates = (this.flags() & TFFlags.CREATION) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.MODIFY) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.ACCESS) ? 1 : 0;\n      if (this._longFormDates()) {\n        return getDate(this._data, 5 + (previousDates * 17));\n      } else {\n        return getShortFormDate(this._data, 5 + (previousDates * 7));\n      }\n    } else {\n      return null;\n    }\n  }\n  public expiration(): Date | null {\n    if (this.flags() & TFFlags.EXPIRATION) {\n      let previousDates = (this.flags() & TFFlags.CREATION) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.MODIFY) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.ACCESS) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.BACKUP) ? 1 : 0;\n      if (this._longFormDates()) {\n        return getDate(this._data, 5 + (previousDates * 17));\n      } else {\n        return getShortFormDate(this._data, 5 + (previousDates * 7));\n      }\n    } else {\n      return null;\n    }\n  }\n  public effective(): Date | null {\n    if (this.flags() & TFFlags.EFFECTIVE) {\n      let previousDates = (this.flags() & TFFlags.CREATION) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.MODIFY) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.ACCESS) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.BACKUP) ? 1 : 0;\n      previousDates += (this.flags() & TFFlags.EXPIRATION) ? 1 : 0;\n      if (this._longFormDates()) {\n        return getDate(this._data, 5 + (previousDates * 17));\n      } else {\n        return getShortFormDate(this._data, 5 + (previousDates * 7));\n      }\n    } else {\n      return null;\n    }\n  }\n  private _longFormDates(): boolean {\n    return Boolean(this.flags() && TFFlags.LONG_FORM);\n  }\n}\n\n/**\n * RockRidge: File data in sparse format.\n * @hidden\n */\nclass SFEntry extends SystemUseEntry {\n  constructor(data: Buffer) {\n    super(data);\n  }\n  public virtualSizeHigh(): number {\n    return this._data.readUInt32LE(4);\n  }\n  public virtualSizeLow(): number {\n    return this._data.readUInt32LE(12);\n  }\n  public tableDepth(): number {\n    return this._data[20];\n  }\n}\n\n/**\n * @hidden\n */\nabstract class Directory<T extends DirectoryRecord> {\n  protected _record: T;\n  private _fileList: string[] = [];\n  private _fileMap: {[name: string]: T} = {};\n  constructor(record: T, isoData: Buffer) {\n    this._record = record;\n    let i = record.lba();\n    let iLimit = i + record.dataLength();\n    if (!(record.fileFlags() & FileFlags.Directory)) {\n      // Must have a CL entry.\n      const cl = <CLEntry> record.getSUEntries(isoData).filter((e) => e instanceof CLEntry)[0];\n      i = cl.childDirectoryLba() * 2048;\n      iLimit = Infinity;\n    }\n\n    while (i < iLimit) {\n      const len = isoData[i];\n      // Zero-padding between sectors.\n      // TODO: Could optimize this to seek to nearest-sector upon\n      // seeing a 0.\n      if (len === 0) {\n        i++;\n        continue;\n      }\n      const r = this._constructDirectoryRecord(isoData.slice(i));\n      const fname = r.fileName(isoData);\n      // Skip '.' and '..' entries.\n      if (fname !== '\\u0000' && fname !== '\\u0001') {\n        // Skip relocated entries.\n        if (!r.hasRockRidge() || r.getSUEntries(isoData).filter((e) => e instanceof REEntry).length === 0) {\n          this._fileMap[fname] = r;\n          this._fileList.push(fname);\n        }\n      } else if (iLimit === Infinity) {\n        // First entry contains needed data.\n        iLimit = i + r.dataLength();\n      }\n      i += r.length();\n    }\n  }\n  /**\n   * Get the record with the given name.\n   * Returns undefined if not present.\n   */\n  public getRecord(name: string): DirectoryRecord {\n    return this._fileMap[name];\n  }\n  public getFileList(): string[] {\n    return this._fileList;\n  }\n  public getDotEntry(isoData: Buffer): T {\n    return this._constructDirectoryRecord(isoData.slice(this._record.lba()));\n  }\n  protected abstract _constructDirectoryRecord(data: Buffer): T;\n}\n\n/**\n * @hidden\n */\nclass ISODirectory extends Directory<ISODirectoryRecord> {\n  constructor(record: ISODirectoryRecord, isoData: Buffer) {\n    super(record, isoData);\n  }\n  protected _constructDirectoryRecord(data: Buffer): ISODirectoryRecord {\n    return new ISODirectoryRecord(data, this._record.getRockRidgeOffset());\n  }\n}\n\n/**\n * @hidden\n */\nclass JolietDirectory extends Directory<JolietDirectoryRecord> {\n  constructor(record: JolietDirectoryRecord, isoData: Buffer) {\n    super(record, isoData);\n  }\n  protected _constructDirectoryRecord(data: Buffer): JolietDirectoryRecord {\n    return new JolietDirectoryRecord(data, this._record.getRockRidgeOffset());\n  }\n}\n\n/**\n * Options for IsoFS file system instances.\n */\nexport interface IsoFSOptions {\n  // The ISO file in a buffer.\n  data: Buffer;\n  // The name of the ISO (optional; used for debug messages / identification via getName()).\n  name?: string;\n}\n\n/**\n * Mounts an ISO file as a read-only file system.\n *\n * Supports:\n * * Vanilla ISO9660 ISOs\n * * Microsoft Joliet and Rock Ridge extensions to the ISO9660 standard\n */\nexport default class IsoFS extends SynchronousFileSystem implements FileSystem {\n  public static readonly Name = \"IsoFS\";\n\n  public static readonly Options: FileSystemOptions = {\n    data: {\n      type: \"object\",\n      description: \"The ISO file in a buffer\",\n      validator: bufferValidator\n    }\n  };\n\n  /**\n   * Creates an IsoFS instance with the given options.\n   */\n  public static Create(opts: IsoFSOptions, cb: BFSCallback<IsoFS>): void {\n    try {\n      cb(null, new IsoFS(opts.data, opts.name));\n    } catch (e) {\n      cb(e);\n    }\n  }\n  public static isAvailable(): boolean {\n    return true;\n  }\n\n  private _data: Buffer;\n  private _pvd: PrimaryOrSupplementaryVolumeDescriptor;\n  private _root: DirectoryRecord;\n  private _name: string;\n\n  /**\n   * **Deprecated. Please use IsoFS.Create() method instead.**\n   *\n   * Constructs a read-only file system from the given ISO.\n   * @param data The ISO file in a buffer.\n   * @param name The name of the ISO (optional; used for debug messages / identification via getName()).\n   */\n  private constructor(data: Buffer, name: string = \"\") {\n    super();\n    this._data = data;\n    // Skip first 16 sectors.\n    let vdTerminatorFound = false;\n    let i = 16 * 2048;\n    const candidateVDs = new Array<PrimaryOrSupplementaryVolumeDescriptor>();\n    while (!vdTerminatorFound) {\n      const slice = data.slice(i);\n      const vd = new VolumeDescriptor(slice);\n      switch (vd.type()) {\n        case VolumeDescriptorTypeCode.PrimaryVolumeDescriptor:\n          candidateVDs.push(new PrimaryVolumeDescriptor(slice));\n          break;\n        case VolumeDescriptorTypeCode.SupplementaryVolumeDescriptor:\n          candidateVDs.push(new SupplementaryVolumeDescriptor(slice));\n          break;\n        case VolumeDescriptorTypeCode.VolumeDescriptorSetTerminator:\n          vdTerminatorFound = true;\n          break;\n      }\n      i += 2048;\n    }\n    if (candidateVDs.length === 0) {\n      throw new ApiError(ErrorCode.EIO, `Unable to find a suitable volume descriptor.`);\n    }\n    candidateVDs.forEach((v) => {\n      // Take an SVD over a PVD.\n      if (!this._pvd || this._pvd.type() !== VolumeDescriptorTypeCode.SupplementaryVolumeDescriptor) {\n        this._pvd = v;\n      }\n    });\n    this._root = this._pvd.rootDirectoryEntry(data);\n    this._name = name;\n  }\n\n  public getName(): string {\n    let name = `IsoFS${this._name}${this._pvd ? `-${this._pvd.name()}` : ''}`;\n    if (this._root && this._root.hasRockRidge()) {\n      name += `-RockRidge`;\n    }\n    return name;\n  }\n\n  public diskSpace(path: string, cb: (total: number, free: number) => void): void {\n    // Read-only file system.\n    cb(this._data.length, 0);\n  }\n\n  public isReadOnly(): boolean {\n    return true;\n  }\n\n  public supportsLinks(): boolean {\n    return false;\n  }\n\n  public supportsProps(): boolean {\n    return false;\n  }\n\n  public supportsSynch(): boolean {\n    return true;\n  }\n\n  public statSync(p: string, isLstat: boolean): Stats {\n    const record = this._getDirectoryRecord(p);\n    if (record === null) {\n      throw ApiError.ENOENT(p);\n    }\n    return this._getStats(p, record)!;\n  }\n\n  public openSync(p: string, flags: FileFlag, mode: number): File {\n    // INVARIANT: Cannot write to RO file systems.\n    if (flags.isWriteable()) {\n      throw new ApiError(ErrorCode.EPERM, p);\n    }\n    // Check if the path exists, and is a file.\n    const record = this._getDirectoryRecord(p);\n    if (!record) {\n      throw ApiError.ENOENT(p);\n    } else if (record.isSymlink(this._data)) {\n      return this.openSync(path.resolve(p, record.getSymlinkPath(this._data)), flags, mode);\n    } else if (!record.isDirectory(this._data)) {\n      const data = record.getFile(this._data);\n      const stats = this._getStats(p, record)!;\n      switch (flags.pathExistsAction()) {\n        case ActionType.THROW_EXCEPTION:\n        case ActionType.TRUNCATE_FILE:\n          throw ApiError.EEXIST(p);\n        case ActionType.NOP:\n          return new NoSyncFile(this, p, flags, stats, data);\n        default:\n          throw new ApiError(ErrorCode.EINVAL, 'Invalid FileMode object.');\n      }\n    } else {\n      throw ApiError.EISDIR(p);\n    }\n  }\n\n  public readdirSync(path: string): string[] {\n    // Check if it exists.\n    const record = this._getDirectoryRecord(path);\n    if (!record) {\n      throw ApiError.ENOENT(path);\n    } else if (record.isDirectory(this._data)) {\n      return record.getDirectory(this._data).getFileList().slice(0);\n    } else {\n      throw ApiError.ENOTDIR(path);\n    }\n  }\n\n  /**\n   * Specially-optimized readfile.\n   */\n  public readFileSync(fname: string, encoding: string, flag: FileFlag): any {\n    // Get file.\n    const fd = this.openSync(fname, flag, 0x1a4);\n    try {\n      const fdCast = <NoSyncFile<IsoFS>> fd;\n      const fdBuff = <Buffer> fdCast.getBuffer();\n      if (encoding === null) {\n        return copyingSlice(fdBuff);\n      }\n      return fdBuff.toString(encoding);\n    } finally {\n      fd.closeSync();\n    }\n  }\n\n  private _getDirectoryRecord(path: string): DirectoryRecord | null {\n    // Special case.\n    if (path === '/') {\n      return this._root;\n    }\n    const components = path.split('/').slice(1);\n    let dir = this._root;\n    for (const component of components) {\n      if (dir.isDirectory(this._data)) {\n        dir = dir.getDirectory(this._data).getRecord(component);\n        if (!dir) {\n          return null;\n        }\n      } else {\n        return null;\n      }\n    }\n    return dir;\n  }\n\n  private _getStats(p: string, record: DirectoryRecord): Stats | null {\n    if (record.isSymlink(this._data)) {\n      const newP = path.resolve(p, record.getSymlinkPath(this._data));\n      const dirRec = this._getDirectoryRecord(newP);\n      if (!dirRec) {\n        return null;\n      }\n      return this._getStats(newP, dirRec);\n    } else {\n      const len = record.dataLength();\n      let mode = 0x16D;\n      const date = record.recordingDate().getTime();\n      let atime = date;\n      let mtime = date;\n      let ctime = date;\n      if (record.hasRockRidge()) {\n        const entries = record.getSUEntries(this._data);\n        for (const entry of entries) {\n          if (entry instanceof PXEntry) {\n            mode = entry.mode();\n          } else if (entry instanceof TFEntry) {\n            const flags = entry.flags();\n            if (flags & TFFlags.ACCESS) {\n              atime = entry.access()!.getTime();\n            }\n            if (flags & TFFlags.MODIFY) {\n              mtime = entry.modify()!.getTime();\n            }\n            if (flags & TFFlags.CREATION) {\n              ctime = entry.creation()!.getTime();\n            }\n          }\n        }\n      }\n      // Mask out writeable flags. This is a RO file system.\n      mode = mode & 0x16D;\n      return new Stats(record.isDirectory(this._data) ? FileType.DIRECTORY : FileType.FILE, len, mode, atime, mtime, ctime);\n    }\n  }\n}\n"]}