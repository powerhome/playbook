name: Release Candidate
run-name: ${{ github.actor }} is creating a Release Candidate Test 
on:
  push

jobs:
  Release-Candidate-Test:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./playbook
    env:
      GEM_HOST_API_KEY: ${{ secrets.RUBYGEMS_API_KEY }}
      NODE_AUTH_TOKEN: ${{secrets.NPM_TOKEN}}
    steps:
      - uses: actions/checkout@v3
      - name: Leave PR comment
        env:
          PR_NUMBER: ${{ github.event.pull_request.number }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          RUBY_GEM_VERSION: '1.0.0' 
          RUBY_GEM_LINK: 'https://rubygems.org/gems/playbook-ui/versions/1.0.0' 
          NPM_VERSION: '1.0.0' 
          NPM_LINK: https://www.npmjs.com/package/playbook-ui/v/1.0.0'
        run: |
          curl -H "Authorization: token ${GITHUB_TOKEN}" \
              -X POST \
              -d '{"body": "Release Candidate Created \n\n Your RC for Ruby Gems is [${{env.RUBY_GEM_VERSION}}](${{env.RUBY_GEM_LINK}}) \n\n Your RC for NPM is [${{env.NPM_VERSION}}](${{env.NPM_LINK}}) "}' \
                "https://api.github.com/repos/${{ github.repository }}/issues/${PR_NUMBER}/comments"
