<form id="example-form-validation" action="" method="get">
    <%= pb_rails("phone_number_input", props: { error: "Missing phone number", id: "validation", initial_country: "af", value: "", required: true }) %>
    <%= pb_rails("button", props: {html_type: "submit", text: "Save Phone Number"}) %>
</form>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Form submission validation
    document.querySelector('#example-form-validation').addEventListener('submit', function (e) {
      if (e.target.querySelectorAll('[error]:not([error=""])').length > 0) e.preventDefault();
    });

    // Add a timeout to ensure the error elements are fully rendered
    setTimeout(function() {
      // Add SVG to error messages
      const errorElements = document.querySelectorAll('.pb_body_kit_negative');

      if (errorElements.length > 0) {
        errorElements.forEach(element => {
          const svgElement = document.createElement('span');
          svgElement.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="auto" height="auto" viewBox="0 0 31 24" fill="none" class="pb_custom_icon svg-inline--fa pb_icon_kit svg_fw" id="" data="{}" aria="{}" tabindex=""><path d="M15.168 3.98438L5.88672 19.2188C5.79297 19.3594 5.79297 19.4531 5.79297 19.5938C5.79297 19.9688 6.07422 20.25 6.44922 20.25H24.5898C24.9648 20.25 25.293 19.9688 25.293 19.5938C25.293 19.4531 25.2461 19.3594 25.1523 19.2188L15.8711 3.98438C15.8242 3.84375 15.6836 3.75 15.543 3.75C15.3555 3.75 15.2617 3.84375 15.168 3.98438ZM13.2461 2.8125C13.7148 2.01562 14.6055 1.5 15.543 1.5C16.4336 1.5 17.3242 2.01562 17.793 2.8125L27.0742 18.0469C27.3555 18.5156 27.543 19.0312 27.543 19.5938C27.543 21.1875 26.2305 22.5 24.5898 22.5H6.44922C4.85547 22.5 3.54297 21.1875 3.54297 19.5938C3.54297 19.0312 3.68359 18.5156 3.96484 18.0469L13.2461 2.8125ZM17.043 17.25C17.043 18.0938 16.3398 18.75 15.543 18.75C14.6992 18.75 14.043 18.0938 14.043 17.25C14.043 16.4531 14.6992 15.75 15.543 15.75C16.3398 15.75 17.043 16.4531 17.043 17.25ZM16.668 8.625V13.125C16.668 13.7812 16.1523 14.25 15.543 14.25C14.8867 14.25 14.418 13.7812 14.418 13.125V8.625C14.418 8.01562 14.8867 7.5 15.543 7.5C16.1523 7.5 16.668 8.01562 16.668 8.625Z" fill="currentColor"></path></svg>';
          svgElement.style.marginRight = '6px';
          svgElement.style.display = 'inline-flex';
          svgElement.style.verticalAlign = 'middle';
          element.prepend(svgElement);
        });
        console.log('Added warning icons to', errorElements.length, 'error elements');
      } else {
        console.log('No error elements found with class .pb_body_kit_negative');
      }
    }, 500); // 500ms delay to ensure elements are loaded
  });
</script>
