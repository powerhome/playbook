@import "../tokens/typography";
@import "../tokens/colors";
@import "../tokens/shadows";
@import "../tokens/border_radius";

[class*="pb_map"] {
  .mapboxgl-map,
  .maplibregl-map {
    font-family: $font_family_base !important;
  }

  .maplibregl-ctrl-attrib-button {
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg width='15' height='15' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M8 0C3.5625 0 0 3.59375 0 8C0 12.4375 3.5625 16 8 16C12.4062 16 16 12.4375 16 8C16 3.59375 12.4062 0 8 0ZM8 14.5C4.40625 14.5 1.5 11.5938 1.5 8C1.5 4.4375 4.40625 1.5 8 1.5C11.5625 1.5 14.5 4.4375 14.5 8C14.5 11.5938 11.5625 14.5 8 14.5ZM9.25 10.5H8.75V7.75C8.75 7.34375 8.40625 7 8 7H7C6.5625 7 6.25 7.34375 6.25 7.75C6.25 8.1875 6.5625 8.5 7 8.5H7.25V10.5H6.75C6.3125 10.5 6 10.8438 6 11.25C6 11.6875 6.3125 12 6.75 12H9.25C9.65625 12 10 11.6875 10 11.25C10 10.8438 9.65625 10.5 9.25 10.5ZM8 6C8.53125 6 9 5.5625 9 5C9 4.46875 8.53125 4 8 4C7.4375 4 7 4.46875 7 5C7 5.5625 7.4375 6 8 6Z' fill='black'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: center;
    background-color: unset !important;

    &:focus {
      box-shadow: unset;
    }
    &:focus-visible {
      box-shadow: 0 0 0 1px $primary_action;
    }
    &:hover {
      box-shadow: $shadow_deep;
    }
  }

  .mapboxgl-ctrl-attrib.mapboxgl-compact,
  .maplibregl-ctrl-attrib.maplibregl-compact {
    background-color: unset;
  }
  .mapboxgl-ctrl-attrib.mapboxgl-compact-show,
  .maplibregl-ctrl-attrib.maplibregl-compact-show {
    background-color: $card_light;
    box-shadow: $shadow_deep;
    color: $text_lt_default;
  }

  .mapboxgl-ctrl-group:not(:empty),
  .maplibregl-ctrl-group:not(:empty) {
    position: absolute;
    top: 150px;
    right: $space_xs + 2;
    margin: unset;
    box-shadow: unset;
    border-radius: $border_radius_md;

    .mapbox-gl-draw_ctrl-draw-btn {
      width: 36px;
      height: 40px;
      box-shadow: $shadow_deep;
      background: $card_light;
      border: solid 1px $border_light;
    }

    .mapbox-gl-draw_polygon {
      border-top-left-radius: $border_radius_md;
      border-top-right-radius: $border_radius_md;
    }

    .mapbox-gl-draw_trash {
      border-bottom-left-radius: $border_radius_md;
      border-bottom-right-radius: $border_radius_md;
    }
  }

  .custom-nav-control {
    position: absolute;
    right: $space_xs + 2;
    top: $space_xs + 2;
    z-index: 2;

    .custom-nav-control-zoom {
      border-radius: $border_radius_md;
      box-shadow: $shadow_deep;
      background: $card_light;
      .map-zoom-in-button {
        border-bottom-left-radius: unset;
        border-bottom-right-radius: unset;
        border-bottom: transparent;
      }
      .map-zoom-out-button {
        border-top-left-radius: unset;
        border-top-right-radius: unset;
      }
    }

    .map-zoom-in-button,
    .map-zoom-out-button,
    .map-flyto-button {
      border: solid 1px $border_light;
      cursor: pointer;
      padding: $space_xs + 1;
      text-align: center;
      color: $text_lt_light;
      background-color: $card_light;
      min-height: 0;

      display: flex;
      justify-content: center;
      align-items: center;

      svg {
        width: $space_xs + 6;
        height: $space_sm;
        display: flex;
      }

      &:hover {
        background-color: darken($bg_light, 2%);
      }

      &:focus-visible {
        border: solid 1px $primary_action;
        box-shadow: unset;
      }
    }

    .map-flyto-button {
      border-radius: $border_radius_md;
      margin-top: $space_xs;
      box-shadow: $shadow_deep;
      background-color: $card_light;
    }
  }

  .maplibregl-popup-content {
    padding: $space_sm;
    background-color: $card_light;
    box-shadow: $shadow_deeper;
  }

  &.dark {
    .maplibregl-canvas {
      filter: invert(100%) brightness(175%) contrast(80%) sepia(50%) saturate(2)
        hue-rotate(185deg);
    }

    .pb_section_separator_kit_card_horizontal::after {
      background: $border_dark;
    }
    .custom-nav-control-zoom {
      border: solid 1px #0a0527;
      background: $bg_dark;
    }

    .maplibregl-popup-content {
      background-color: $bg_dark;
      color: $text_dk_default;
    }

    .mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip,
    .maplibregl-popup-anchor-bottom .maplibregl-popup-tip {
      border-top-color: $bg_dark;
    }
    .map-zoom-in-button,
    .map-zoom-out-button,
    .map-flyto-button {
      color: $text_dk_default;
      background-color: $bg_dark;
      border-color: $border_dark;

      &:hover {
        background-color: #221e3d;
      }
    }

    .maplibregl-ctrl-attrib-button {
      background-color: $text_dk_light;
    }
    .mapboxgl-ctrl-attrib.mapboxgl-compact-show,
    .maplibregl-ctrl-attrib.maplibregl-compact-show {
      background-color: $bg_dark;
      box-shadow: $shadow_deep;
      color: $text_dk_default;
      a {
        color: $text_dk_default;
      }
    }
  }
}
