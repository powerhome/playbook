<%= content_tag(:div,
  id: object.id,
  data: object.data,
  class: object.classname) do %>

  <% if object.multi %>
    <%= check_box_tag(object.name, object.value, object.checked, object.additional_input_options) %>
  <% else %>
    <%= radio_button_tag(object.name, object.value, object.checked, object.additional_input_options) %>
  <% end %>

  <label class="<%= object.label_class %>" for="<%= object.input_id_present %>">
    <div class="buffer">
      <% if object.variant == "display_input" %>
        <%= pb_rails("flex", props: { vertical: "center" }) do %>
          <%= pb_rails("flex", props: {
            orientation: "column",
            padding: "sm",
            padding_right: "xs",
            vertical: "center",
          }) do %>
            <%= pb_rails(object.input, props: { text: "" }) do %>
              <input <%= object.is_checked %> <%= object.is_disabled %> id="checkbox-styled" name="<%= object.name %>-display" type="<%= object.input %>">
            <% end %>
          <% end %>
          <div class="separator"></div>
          <%= pb_rails("card/card_body", props: { padding: "sm" }) do %>
            <% if object.children.nil? %>
              <%= pb_rails("body", props: { text: object.text }) %>
            <% else %>
              <%= capture(&object.children) %>
            <% end %>
          <% end %>
        <% end %>
      <% else %>
        <% if object.children.nil? %>
          <%= pb_rails("body", props: { text: object.text }) %>
        <% else %>
          <%= capture(&object.children) %>
        <% end %>
        <% if object.icon %>
          <div class="pb_selectable_card_circle">
            <%= pb_rails("icon", props: { icon: "check", fixed_width: true }) %>
          </div>
        <% end %>
      <% end %>
    </div>
  </label>

  <% if object.variant == "display_input" %>
    <script>
      var outerCheckbox = document.querySelector("input#<%= object.input_id || object.name %>")
      var innerCheckbox = outerCheckbox.parentElement.querySelector("input#checkbox-styled")

      outerCheckbox.addEventListener("change", () => {
        const outerCheckbox = document.querySelector("input#<%= object.input_id || object.name %>")
        const innerCheckbox = outerCheckbox.parentElement.querySelector("input#checkbox-styled")
        innerCheckbox.checked = outerCheckbox.checked
      })

      innerCheckbox.addEventListener("change", () => {
        const outerCheckbox = document.querySelector("input#<%= object.input_id || object.name %>")
        const innerCheckbox = outerCheckbox.parentElement.querySelector("input#checkbox-styled")
        outerCheckbox.checked = innerCheckbox.checked
      })
    </script>
  <% end %>
<% end %>

<script>
  var outerCheckbox = document.querySelector("input#<%= object.input_id || object.name %>")
  var innerCheckbox = outerCheckbox.parentElement.querySelector("input#checkbox-styled")

  outerCheckbox.addEventListener("change", () => {
    const outerCheckbox = document.querySelector("input#<%= object.input_id || object.name %>")
    const innerCheckbox = outerCheckbox.parentElement.querySelector("input#checkbox-styled")
    innerCheckbox.checked = outerCheckbox.checked
  })

  innerCheckbox.addEventListener("change", () => {
    const outerCheckbox = document.querySelector("input#<%= object.input_id || object.name %>")
    const innerCheckbox = outerCheckbox.parentElement.querySelector("input#checkbox-styled")
    outerCheckbox.checked = innerCheckbox.checked
  })
</script>
